<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>OrbitalShield</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Import map for Three.js -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.150.1/build/three.module.js",
      "OrbitControls": "https://unpkg.com/three@0.150.1/examples/jsm/controls/OrbitControls.js",
      "CSS2DRenderer": "https://unpkg.com/three@0.150.1/examples/jsm/renderers/CSS2DRenderer.js"
    }
  }
  </script>

  <!-- External CSS -->
  <link rel="stylesheet" href="style.css" />
  
  <!-- Defense System Module -->
  <script src="defense-system.js"></script>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loadingScreen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; color: #fff; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; font-family: Arial, sans-serif;">
    <div style="text-align: center;">
      <h2 style="margin-bottom: 20px; color: #ffffff;">OrbitalShield</h2>
      <div id="loadingProgress" style="margin-bottom: 15px;">Initializing...</div>
      <div style="width: 300px; height: 6px; background: #333; border-radius: 3px; overflow: hidden;">
        <div id="progressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #666666, #aaaaaa); transition: width 0.3s ease;"></div>
      </div>
      <div id="loadingDetails" style="margin-top: 15px; font-size: 14px; color: #aaa;">Loading textures...</div>
    </div>
  </div>

  <!-- Scroll to Enter Page -->
  <div id="enterScreen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: url('starmap.jpg') center center / cover no-repeat, linear-gradient(135deg, #000000 0%, #000 100%); color: #fff; display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 999; font-family: Arial, sans-serif; overflow: hidden;">
    <!-- Dark overlay for better text readability -->
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.4); z-index: 1;"></div>
    
    <div style="text-align: center; max-width: 600px; padding: 40px; position: relative; z-index: 2;">
      <h1 style="font-size: 3.5em; margin-bottom: 20px; background: linear-gradient(45deg, #ffffff, #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-shadow: 2px 2px 4px rgba(0,0,0,0.7);">OrbitalShield</h1>
      <p style="font-size: 1.3em; margin-bottom: 30px; color: #cccccc; line-height: 1.6; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">Real time Near-Earth Asteroid tracking and impact assessment using NASA's NeoWS API</p>
      <div style="margin: 40px 0;">
        <div style="display: inline-block; padding: 15px 25px; border: 2px solid #ffffff; border-radius: 50px; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(10px);">
          <span style="font-size: 1.1em; color: #ffffff; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">Scroll down to explore</span>
        </div>
      </div>
      <div style="margin-top: 50px; animation: bounce 2s infinite;">
        <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.8));">
          <polyline points="6,9 12,15 18,9"></polyline>
        </svg>
      </div>
    </div>
    <style>
      @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-10px); }
        60% { transform: translateY(-5px); }
      }
    </style>
  </div>

  <!-- Three.js canvas - initially hidden during loading/scroll phases -->
  <div id="canvas" style="opacity: 0; transition: opacity 0.8s ease;"></div>
  
  <!-- UI Overlay -->
  <div id="ui-overlay" style="opacity: 0; transition: opacity 0.8s ease;">
    <div id="header" style="position: relative;">
      <h1>OrbitalShield</h1>
      <div style="position: absolute; top: 10px; right: 20px;">
  <span id="searchIcon" class="search-icon"></span>
  <input id="asteroidSearch" type="text" placeholder="Search asteroid..." style="padding: 4px 10px; border-radius: 4px; border: 1px solid #888; min-width: 180px; display:none;" autocomplete="off" />
  <div id="searchResults" style="position: absolute; right: 0; background: #222; color: #fff; border-radius: 0 0 6px 6px; box-shadow: 0 2px 8px #0008; z-index: 100; display: none; max-height: 220px; overflow-y: auto;"></div>
      </div>
    </div>

    <div id="controls">
      <div class="controls-header">
        <div class="legend">
          <span class="box" style="background:#ff4444"></span> Hazardous &nbsp;&nbsp;
          <span class="box" style="background:#44ff88"></span> Safe
        </div>
        <button id="toggleControls" title="Minimize/Expand Controls">"<"</button>
      </div>

      <div id="controlsContent">


        <!-- Asteroid Count Control -->
        <div id="countControls" style="margin-top: 12px;">
          <label for="asteroidCount">No. of Asteroids to Plot</label><br>
          <input type="number" id="asteroidCount" min="1" max="200" step="1" value="20" style="width: 80px;" />
          <button id="refreshBtn" style="margin-left: 8px; padding: 4px 8px;">ğŸ”„ Refresh</button>
        </div>

        <!-- Impact Location Simulation -->
        <div id="impactLocationControls" style="margin-top: 12px;">
          <div class="dropdown-header" onclick="toggleDropdown('impactLocationContent')" style="cursor: pointer; background: rgba(255, 204, 0, 0.1); border: 1px solid #ffcc00; border-radius: 6px; padding: 8px; display: flex; align-items: center; justify-content: space-between;">
            <label style="color: #ffcc00; font-weight: bold; margin: 0;">ğŸ¯ Impact Location Simulator</label>
            <span id="impactLocationArrow" style="color: #ffcc00; font-weight: bold; transform: rotate(-90deg); transition: transform 0.3s;">â–¼</span>
          </div>
          <div id="impactLocationContent" style="display: none; margin-top: 8px; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 4px; border: 1px solid #333;">
            <!-- City Selection Dropdown -->
            <div style="margin-bottom: 8px;">
              <label style="color: #ccc; font-size: 12px; margin-bottom: 4px; display: block;">ğŸŒ Select Target City:</label>
              <select id="citySelect" style="width: 100%; padding: 6px; background: #222; border: 1px solid #555; border-radius: 4px; color: #fff; font-size: 11px;">
                <option value="" style="background: #222; color: #ccc;">-- Choose a city --</option>
                
                <!-- NORTH AMERICA -->
                <optgroup label="ï¿½ NORTH AMERICA">
                  <!-- United States -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡ºğŸ‡¸ United States</option>
                  <option value="40.7128,-74.0060">â”œâ”€â”€ ğŸ™ï¸ New York City (8.3M)</option>
                  <option value="34.0522,-118.2437">â”œâ”€â”€ ğŸŒ´ Los Angeles (13.2M)</option>
                  <option value="41.8781,-87.6298">â”œâ”€â”€ ğŸ¢ Chicago (9.5M)</option>
                  <option value="29.7604,-95.3698">â”œâ”€â”€ ğŸš€ Houston (7.1M)</option>
                  <option value="25.7617,-80.1918">â”œâ”€â”€ ğŸ–ï¸ Miami (6.2M)</option>
                  <option value="32.7767,-96.7970">â”œâ”€â”€ ğŸ¤  Dallas (7.6M)</option>
                  <option value="39.9526,-75.1652">â”œâ”€â”€ ğŸ”” Philadelphia (6.1M)</option>
                  <option value="38.9072,-77.0369">â””â”€â”€ ğŸ›ï¸ Washington D.C. (6.3M)</option>
                  
                  <!-- Canada -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡¨ğŸ‡¦ Canada</option>
                  <option value="43.6532,-79.3832">â”œâ”€â”€ ğŸ Toronto (6.2M)</option>
                  <option value="49.2827,-123.1207">â””â”€â”€ â›°ï¸ Vancouver (2.6M)</option>
                  
                  <!-- Mexico -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡²ğŸ‡½ Mexico</option>
                  <option value="19.4326,-99.1332">â””â”€â”€ ğŸŒ® Mexico City (21.8M)</option>
                </optgroup>

                <!-- EUROPE -->
                <optgroup label="ï¿½ EUROPE">
                  <!-- United Kingdom -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡¬ğŸ‡§ United Kingdom</option>
                  <option value="51.5074,-0.1278">â””â”€â”€ ğŸ° London (9.5M)</option>
                  
                  <!-- France -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡«ğŸ‡· France</option>
                  <option value="48.8566,2.3522">â””â”€â”€ ğŸ—¼ Paris (11.0M)</option>
                  
                  <!-- Germany -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡©ğŸ‡ª Germany</option>
                  <option value="52.5200,13.4050">â”œâ”€â”€ ğŸ§± Berlin (3.7M)</option>
                  <option value="53.5511,9.9937">â”œâ”€â”€ âš“ Hamburg (1.9M)</option>
                  <option value="48.1351,11.5820">â”œâ”€â”€ ğŸº Munich (2.6M)</option>
                  <option value="50.1109,8.6821">â””â”€â”€ ğŸ¢ Frankfurt (2.3M)</option>
                  
                  <!-- Spain -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡ªğŸ‡¸ Spain</option>
                  <option value="40.4168,-3.7038">â”œâ”€â”€ ğŸ’ƒ Madrid (6.7M)</option>
                  <option value="41.3851,2.1734">â””â”€â”€ ğŸ–ï¸ Barcelona (5.6M)</option>
                  
                  <!-- Italy -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡®ğŸ‡¹ Italy</option>
                  <option value="41.9028,12.4964">â””â”€â”€ ğŸ›ï¸ Rome (4.3M)</option>
                  
                  <!-- Russia -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡·ğŸ‡º Russia</option>
                  <option value="55.7558,37.6173">â”œâ”€â”€ ğŸ›ï¸ Moscow (12.5M)</option>
                  <option value="59.9311,30.3609">â””â”€â”€ â„ï¸ St. Petersburg (5.4M)</option>
                  
                  <!-- Turkey -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡¹ğŸ‡· Turkey</option>
                  <option value="41.0082,28.9784">â””â”€â”€ ğŸ•Œ Istanbul (15.5M)</option>
                  
                  <!-- Nordic Countries -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸŒ¨ï¸ Nordic Countries</option>
                  <option value="55.6761,12.5683">â”œâ”€â”€ ğŸ§œâ€â™€ï¸ Copenhagen, Denmark (2.1M)</option>
                  <option value="59.3293,18.0686">â”œâ”€â”€ ğŸ° Stockholm, Sweden (2.4M)</option>
                  <option value="60.1695,24.9354">â”œâ”€â”€ â„ï¸ Helsinki, Finland (1.5M)</option>
                  <option value="59.9139,10.7522">â””â”€â”€ ğŸ”ï¸ Oslo, Norway (1.7M)</option>
                  
                  <!-- Other Europe -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡ªğŸ‡º Other Europe</option>
                  <option value="50.0755,14.4378">â”œâ”€â”€ ğŸ° Prague, Czech Republic (1.3M)</option>
                  <option value="47.4979,19.0402">â”œâ”€â”€ ğŸ° Budapest, Hungary (1.8M)</option>
                  <option value="53.3498,-6.2603">â”œâ”€â”€ â˜˜ï¸ Dublin, Ireland (1.4M)</option>
                  <option value="38.7223,-9.1393">â”œâ”€â”€ ğŸ° Lisbon, Portugal (2.9M)</option>
                  <option value="46.2044,6.1432">â”œâ”€â”€ ï¿½ï¸ Geneva, Switzerland (0.6M)</option>
                  <option value="47.3769,8.5417">â”œâ”€â”€ ğŸ’° Zurich, Switzerland (1.4M)</option>
                  <option value="48.2082,16.3738">â”œâ”€â”€ ğŸ­ Vienna, Austria (1.9M)</option>
                  <option value="50.8503,4.3517">â”œâ”€â”€ ğŸ« Brussels, Belgium (1.2M)</option>
                  <option value="52.3676,4.9041">â””â”€â”€ ğŸŒ· Amsterdam, Netherlands (2.4M)</option>
                </optgroup>

                <!-- ASIA -->
                <optgroup label="ğŸŒ ASIA">
                  <!-- China -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡¨ğŸ‡³ China</option>
                  <option value="39.9042,116.4074">â”œâ”€â”€ ğŸ® Beijing (21.5M)</option>
                  <option value="31.2304,121.4737">â””â”€â”€ ğŸ™ï¸ Shanghai (24.8M)</option>
                  
                  <!-- Japan -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡¯ğŸ‡µ Japan</option>
                  <option value="35.6762,139.6503">â”œâ”€â”€ ğŸ¯ Tokyo (38.0M)</option>
                  <option value="35.6804,139.7690">â””â”€â”€ ğŸŒ¸ Osaka (18.9M)</option>
                  
                  <!-- India -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡®ğŸ‡³ India</option>
                  <option value="28.6139,77.2090">â”œâ”€â”€ ğŸ•Œ Delhi (33.0M)</option>
                  <option value="19.0760,72.8777">â”œâ”€â”€ ğŸ™ï¸ Mumbai (21.0M)</option>
                  <option value="12.9716,77.5946">â””â”€â”€ ğŸ’» Bangalore (13.2M)</option>
                  
                  <!-- South Korea -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡°ğŸ‡· South Korea</option>
                  <option value="37.5665,126.9780">â””â”€â”€ ğŸ™ï¸ Seoul (25.5M)</option>
                  <option value="35.6804,139.7690">ğŸŒ¸ Osaka, Japan (18.9M)</option>
                  <option value="1.3521,103.8198">ï¿½ï¸ Singapore (5.9M)</option>
                  <option value="3.1390,101.6869">ğŸ¢ Kuala Lumpur, Malaysia (8.6M)</option>
                  <option value="13.7563,100.5018">ğŸ¯ Bangkok, Thailand (10.5M)</option>
                  <option value="10.8231,106.6297">ğŸ™ï¸ Ho Chi Minh City, Vietnam (9.3M)</option>
                  <option value="14.5995,120.9842">ğŸï¸ Manila, Philippines (25.7M)</option>
                                    <option value="-6.2088,106.8456">â””â”€â”€ ğŸ™ï¸ Jakarta, Indonesia (35.0M)</option>
                  
                  <!-- Middle East -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸœï¸ Middle East</option>
                  <option value="25.2048,55.2708">â”œâ”€â”€ ğŸ—ï¸ Dubai, UAE (3.5M)</option>
                  <option value="24.4539,54.3773">â”œâ”€â”€ ğŸ•Œ Abu Dhabi, UAE (1.5M)</option>
                  <option value="35.6892,51.3890">â”œâ”€â”€ ğŸ›ï¸ Tehran, Iran (9.5M)</option>
                  <option value="24.7136,46.6753">â”œâ”€â”€ ğŸº Riyadh, Saudi Arabia (7.7M)</option>
                  <option value="33.3152,44.3661">â”œâ”€â”€ ğŸ›ï¸ Baghdad, Iraq (7.5M)</option>
                  <option value="29.3117,47.4818">â”œâ”€â”€ ğŸ›¢ï¸ Kuwait City, Kuwait (4.1M)</option>
                  <option value="26.2285,50.5860">â”œâ”€â”€ ğŸ’° Manama, Bahrain (0.7M)</option>
                  <option value="25.3548,51.1839">â”œâ”€â”€ âš½ Doha, Qatar (2.4M)</option>
                  <option value="23.4241,53.8478">â”œâ”€â”€ ğŸ›ï¸ Muscat, Oman (1.6M)</option>
                  <option value="33.8869,35.5131">â”œâ”€â”€ ğŸŒ² Beirut, Lebanon (2.4M)</option>
                  <option value="33.5138,36.2765">â”œâ”€â”€ ğŸ›ï¸ Damascus, Syria (2.1M)</option>
                  <option value="31.7683,35.2137">â”œâ”€â”€ ğŸ•Šï¸ Jerusalem, Israel/Palestine (1.0M)</option>
                  <option value="32.0853,34.7818">â”œâ”€â”€ ğŸ–ï¸ Tel Aviv, Israel (4.3M)</option>
                  <option value="31.9686,35.9023">â””â”€â”€ ğŸ›ï¸ Amman, Jordan (4.0M)</option>
                </optgroup>

                <!-- AFRICA -->
                <optgroup label="ğŸŒ AFRICA">
                  <!-- Egypt -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡ªğŸ‡¬ Egypt</option>
                  <option value="30.0444,31.2357">â”œâ”€â”€ ğŸº Cairo (21.3M)</option>
                  <option value="30.0626,31.2497">â”œâ”€â”€ ğŸº Giza (9.2M)</option>
                  <option value="31.2001,29.9187">â””â”€â”€ ğŸ›ï¸ Alexandria (5.2M)</option>
                  
                  <!-- Nigeria -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡³ğŸ‡¬ Nigeria</option>
                  <option value="6.5244,3.3792">â”œâ”€â”€ ğŸ™ï¸ Lagos (15.3M)</option>
                  <option value="6.5244,3.3792">â”œâ”€â”€ ğŸ™ï¸ Abuja (3.3M)</option>
                  <option value="12.9716,77.5946">â””â”€â”€ ğŸ’» Kano (4.1M)</option>
                  
                  <!-- South Africa -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡¿ğŸ‡¦ South Africa</option>
                  <option value="-26.2041,28.0473">â”œâ”€â”€ ğŸ’ Johannesburg (10.0M)</option>
                  <option value="-33.9249,18.4241">â”œâ”€â”€ ğŸ”ï¸ Cape Town (4.6M)</option>
                  <option value="-29.8587,31.0218">â”œâ”€â”€ ğŸ–ï¸ Durban (3.7M)</option>
                  <option value="-25.7479,28.2293">â””â”€â”€ ğŸ›ï¸ Pretoria (2.9M)</option>
                  
                  <!-- Other Africa -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸŒ Other Africa</option>
                  <option value="-1.2921,36.8219">â”œâ”€â”€ ğŸ¦ Nairobi, Kenya (4.4M)</option>
                  <option value="9.0579,38.7499">â”œâ”€â”€ ğŸ›ï¸ Addis Ababa, Ethiopia (5.0M)</option>
                  <option value="-6.7924,39.2083">â”œâ”€â”€ ğŸŒŠ Dar es Salaam, Tanzania (6.7M)</option>
                  <option value="33.5731,-7.5898">â”œâ”€â”€ ğŸ›ï¸ Casablanca, Morocco (3.8M)</option>
                  <option value="15.5007,32.5599">â”œâ”€â”€ ğŸº Khartoum, Sudan (6.1M)</option>
                  <option value="5.6037,-0.1870">â”œâ”€â”€ ğŸŒ Accra, Ghana (4.3M)</option>
                  <option value="0.3476,32.5825">â”œâ”€â”€ ğŸ¦ Kampala, Uganda (3.3M)</option>
                  <option value="-1.9706,30.1044">â”œâ”€â”€ ğŸ¦ Kigali, Rwanda (1.3M)</option>
                  <option value="36.8065,10.1815">â”œâ”€â”€ ğŸ›ï¸ Tunis, Tunisia (2.3M)</option>
                  <option value="36.7538,3.0588">â”œâ”€â”€ ğŸ›ï¸ Algiers, Algeria (7.8M)</option>
                  <option value="-15.3875,28.3228">â”œâ”€â”€ ğŸ’ Lusaka, Zambia (3.1M)</option>
                  <option value="-17.8292,31.0522">â””â”€â”€ ğŸ›ï¸ Harare, Zimbabwe (2.1M)</option>
                </optgroup>

                <!-- SOUTH AMERICA -->
                <optgroup label="ï¿½ SOUTH AMERICA">
                  <option value="30.0444,31.2357">ğŸº Cairo, Egypt (21.3M)</option>
                  <option value="24.7136,46.6753">ï¿½ï¸ Riyadh, Saudi Arabia (7.7M)</option>
                  <option value="33.3152,44.3661">ğŸ›ï¸ Baghdad, Iraq (7.5M)</option>
                  <option value="35.6892,51.3890">ğŸ›ï¸ Tehran, Iran (9.5M)</option>
                  <option value="-1.2921,36.8219">ğŸ¦ Nairobi, Kenya (4.4M)</option>
                  <option value="6.5244,3.3792">ğŸ™ï¸ Lagos, Nigeria (15.3M)</option>
                  <option value="-26.2041,28.0473">ğŸ’ Johannesburg, South Africa (10.0M)</option>
                  <option value="-33.9249,18.4241">ğŸ”ï¸ Cape Town, South Africa (4.6M)</option>
                  <option value="9.0579,38.7499">ğŸ›ï¸ Addis Ababa, Ethiopia (5.0M)</option>
                  <option value="-6.7924,39.2083">ï¿½ï¸ Dar es Salaam, Tanzania (6.7M)</option>
                  <option value="33.5731,-7.5898">ğŸ›ï¸ Casablanca, Morocco (3.8M)</option>
                </optgroup>

                <!-- South America -->
                <optgroup label="ğŸŒ South America">
                  <!-- Brazil -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡§ğŸ‡· Brazil</option>
                  <option value="-23.5505,-46.6333">â”œâ”€â”€ ğŸ™ï¸ SÃ£o Paulo (22.4M)</option>
                  <option value="-22.9068,-43.1729">â”œâ”€â”€ ğŸ–ï¸ Rio de Janeiro (13.3M)</option>
                  <option value="-19.9167,-43.9345">â””â”€â”€ ğŸ’ Belo Horizonte (6.1M)</option>
                  
                  <!-- Argentina -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡¦ğŸ‡· Argentina</option>
                  <option value="-34.6118,-58.3960">â””â”€â”€ ğŸ’ƒ Buenos Aires (15.2M)</option>
                  
                  <!-- Colombia -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡¨ğŸ‡´ Colombia</option>
                  <option value="4.7110,-74.0721">â”œâ”€â”€ ğŸ›ï¸ BogotÃ¡ (11.0M)</option>
                  <option value="6.2442,-75.5812">â””â”€â”€ ğŸŒº MedellÃ­n (4.0M)</option>
                  
                  <!-- Other South America -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸŒ Other South America</option>
                  <option value="-12.0464,-77.0428">â”œâ”€â”€ ğŸ›ï¸ Lima, Peru (10.9M)</option>
                  <option value="-33.4489,-70.6693">â”œâ”€â”€ â›°ï¸ Santiago, Chile (7.2M)</option>
                  <option value="10.4806,-66.9036">â”œâ”€â”€ ğŸ›ï¸ Caracas, Venezuela (2.9M)</option>
                  <option value="-0.1807,-78.4678">â”œâ”€â”€ ğŸŒ‹ Quito, Ecuador (2.8M)</option>
                  <option value="-25.2637,-57.5759">â”œâ”€â”€ ğŸŒ¿ AsunciÃ³n, Paraguay (3.2M)</option>
                  <option value="-34.9011,-56.1645">â”œâ”€â”€ ğŸ–ï¸ Montevideo, Uruguay (1.7M)</option>
                  <option value="-16.2902,-63.5887">â”œâ”€â”€ ğŸ”ï¸ Santa Cruz, Bolivia (1.4M)</option>
                  <option value="-17.7834,-63.1821">â””â”€â”€ ğŸ›ï¸ La Paz, Bolivia (2.3M)</option>
                </optgroup>

                <!-- OCEANIA -->
                <optgroup label="ğŸï¸ OCEANIA">
                  <!-- Australia -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡¦ğŸ‡º Australia</option>
                  <option value="-33.8688,151.2093">â”œâ”€â”€ ğŸ–ï¸ Sydney (5.3M)</option>
                  <option value="-37.8136,144.9631">â”œâ”€â”€ â˜• Melbourne (5.1M)</option>
                  <option value="-27.4698,153.0251">â”œâ”€â”€ â˜€ï¸ Brisbane (2.6M)</option>
                  <option value="-31.9505,115.8605">â””â”€â”€ ğŸŒŠ Perth (2.1M)</option>
                  
                  <!-- New Zealand -->
                  <option value="" disabled style="background: #333; color: #ffcc00; font-weight: bold;">ğŸ‡³ğŸ‡¿ New Zealand</option>
                  <option value="-36.8485,174.7633">â”œâ”€â”€ ğŸ‘ Auckland (1.7M)</option>
                  <option value="-41.2865,174.7762">â”œâ”€â”€ ğŸŒ¿ Wellington (0.4M)</option>
                  <option value="-43.5321,172.6362">â””â”€â”€ ğŸ”ï¸ Christchurch (0.4M)</option>
                </optgroup>
              </select>
            </div>
            
            <!-- Manual Coordinates (Optional) -->
            <div style="margin-bottom: 8px;">
              <label style="color: #888; font-size: 10px; margin-bottom: 4px; display: block;">Or enter custom coordinates:</label>
              <div style="display: flex; gap: 8px;">
                <input type="number" id="impactLat" placeholder="Latitude" step="0.1" style="width: 80px; padding: 4px; background: rgba(255,255,255,0.05); border: 1px solid #444; border-radius: 3px; color: #aaa; font-size: 10px;" />
                <input type="number" id="impactLng" placeholder="Longitude" step="0.1" style="width: 80px; padding: 4px; background: rgba(255,255,255,0.05); border: 1px solid #444; border-radius: 3px; color: #aaa; font-size: 10px;" />
                <button id="simulateImpact" style="padding: 4px 8px; background: rgba(255, 68, 68, 0.2); border: 1px solid #ff4444; color: #ff4444; border-radius: 3px; font-size: 10px;">Simulate</button>
              </div>
            </div>
            
            <button id="showImpactMap" style="font-size: 11px; padding: 6px 12px; background: rgba(255, 204, 0, 0.2); border: 1px solid #ffcc00; color: #ffcc00; border-radius: 3px; width: 100%;">ğŸ—ºï¸ View Impact Map</button>
          </div>
        </div>

        <!-- Asteroid Visibility Control -->
        <div id="sizeControls" style="margin-top: 12px; flex-direction: column; align-items: stretch;">
          <label for="sizeRatio">Asteroid Visibility</label> 
          <div class="slider-row">
            <input type="range" id="sizeRatio" min="1" max="25" step="1" value="1" />
            <span id="sizeRatioValue">1x</span>
          </div>
        </div>

        <!-- Enhanced Deflection Strategy Panel -->
        <div id="simulationControls">
          <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 8px; border: 1px solid #444;">
            <div class="dropdown-header" onclick="toggleDropdown('defenseContent')" style="cursor: pointer; background: rgba(255, 204, 0, 0.1); border: 1px solid #ffcc00; border-radius: 6px; padding: 8px; display: flex; align-items: center; justify-content: space-between; margin: -12px -12px 12px -12px;">
              <h3 style="margin: 0; color: #ffcc00; font-size: 14px;">ğŸ›¡ï¸ Planetary Defense Mission</h3>
              <span id="defenseArrow" style="color: #ffcc00; font-weight: bold; transform: rotate(-90deg); transition: transform 0.3s;">â–¼</span>
            </div>
            
            <div id="defenseContent" style="display: none;">
              <!-- Auto Optimize Toggle -->
              <div style="margin: 6px 0 12px 0; display:flex; align-items:center; justify-content:space-between; gap:8px;">
                <label style="display:flex; align-items:center; gap:8px; color:#ccc;">
                  <input type="checkbox" id="autoOptimize" checked style="margin-right: 4px;" />
                  Auto-Optimize (recommended)
                </label>
                <span style="font-size:10px; color:#888;">Toggle off to manually adjust parameters</span>
              </div>
              
              <!-- Mission Method Selection -->
              <div style="margin-bottom: 12px;">
                <label for="mitigationMethod" style="color: #ccc; font-weight: bold;">Deflection Method:</label>
                <select id="mitigationMethod" style="width: 100%; padding: 6px; margin-top: 4px; background: rgba(255,255,255,0.1); border: 1px solid #555; border-radius: 4px; color: #fff;">
                  <option value="kinetic">ğŸ¯ Kinetic Impactor (DART-style)</option>
                  <option value="gravity">ğŸŒŒ Gravity Tractor</option>
                  <option value="nuclear">ğŸ’¥ Nuclear Deflection</option>
                  <option value="laser">âš¡ Laser Ablation</option>
                  <option value="ion">ğŸ”‹ Ion Beam Shepherd</option>
                  <option value="mass_driver">ğŸš€ Mass Driver</option>
                </select>
              </div>

              <!-- Mission Timeline -->
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px;">
                <div>
                  <label for="yearsOut" style="color: #ccc; font-size: 12px;">Years to Impact:</label>
                  <input type="number" id="yearsOut" min="0.5" max="50" step="0.5" value="5" style="width: 100%; padding: 4px; background: rgba(255,255,255,0.1); border: 1px solid #555; border-radius: 3px; color: #fff;" />
                </div>
                <div>
                  <label for="missionDuration" style="color: #ccc; font-size: 12px;">Mission Duration (years):</label>
                  <input type="number" id="missionDuration" min="0.1" max="10" step="0.1" value="1.0" style="width: 100%; padding: 4px; background: rgba(255,255,255,0.1); border: 1px solid #555; border-radius: 3px; color: #fff;" />
                </div>
              </div>

              <!-- Delta-V Control -->
              <div style="margin-bottom: 12px;">
                <label for="deltaV" style="color: #ccc; font-weight: bold;">Î”V Applied:</label>
                <div style="display: flex; align-items: center; gap: 8px; margin-top: 4px;">
                  <input type="range" id="deltaV" min="0" max="500" step="0.1" value="0" style="flex: 1;" />
                  <span id="deltaVValue" style="color: #ffcc00; font-weight: bold; min-width: 80px;">0.0 mm/s</span>
                </div>
                <div style="font-size: 11px; color: #888; margin-top: 2px;">
                  Typical range: 0.1-100 mm/s (depends on method and timing)
                </div>
              </div>

              <!-- Spacecraft Mass Parameters -->
              <div style="margin-bottom: 12px;">
                <div>
                  <label for="spacecraftMass" style="color: #ccc; font-size: 12px;">Spacecraft Mass (kg):</label>
                  <input type="number" id="spacecraftMass" min="500" max="50000" step="50" value="" placeholder="Auto-Optimized" style="width: 100%; padding: 4px; background: rgba(255,255,255,0.1); border: 1px solid #555; border-radius: 3px; color: #fff;" title="Leave empty for method-optimal mass" />
                </div>
              </div>
              
              <div style="font-size: 10px; color: #888; margin-bottom: 12px; text-align: center; padding: 4px; background: rgba(0,0,0,0.3); border-radius: 3px;">
                ğŸ’¡ Auto-optimization adjusts parameters based on asteroid characteristics<br>
                Method defaults: Kinetic(850kg), Gravity(2000kg), Nuclear(5000kg), Others(1400-4500kg)
              </div>

              <!-- Mission Results Display -->
              <div id="deflectionResults" style="background: rgba(0,0,0,0.4); padding: 12px; border-radius: 6px; border-left: 4px solid #ffcc00; margin-bottom: 8px;">
                <div style="color: #ffcc00; font-weight: bold; margin-bottom: 8px; font-size: 13px;">ğŸ“Š Mission Analysis</div>
                <div id="mitigationResult" style="color: #44ff88; font-weight: bold; margin-bottom: 6px; font-size: 12px;">
                  Miss Distance: Select parameters above
                </div>
                <div id="mitigationEfficiency" style="font-size: 11px; color: #aaa; margin-bottom: 6px;">
                  Method details will appear here
                </div>
                <div id="missionFeasibility" style="font-size: 11px; color: #ccc; margin-bottom: 6px;">
                  Mission feasibility: Not calculated
                </div>
              </div>

              <!-- Advanced Physics Display -->
              <div id="physicsDetails" style="padding: 8px; background: rgba(0,0,0,0.3); border-radius: 4px; border: 1px solid #333; margin-bottom: 8px;">
                <div style="font-size: 11px; color: #aaa; margin-bottom: 6px;">ï¿½ Physics Analysis</div>
                <div id="orbitalMechanics" style="font-size: 10px; color: #bbb; line-height: 1.4;">
                  â€¢ Orbital velocity change: 0 m/s<br>
                  â€¢ Deflection angle: 0.000Â°<br>
                  â€¢ Energy efficiency: 0%<br>
                  â€¢ Success probability: 0%
                </div>
              </div>
            </div>
          </div>
          
          <!-- Enhanced Information Panel -->
          <div id="infoPanel" style="margin-top: 12px;">
            <div style="margin-bottom: 8px;">
              <button id="educationalMode" style="padding: 4px 8px; font-size: 12px;">ğŸ“š Educational Mode</button>
              <button id="gamificationMode" style="padding: 4px 8px; font-size: 12px; margin-left: 4px;">ğŸ® Defend Earth</button>
              <button id="scenarioMode" style="padding: 4px 8px; font-size: 12px; margin-left: 4px;">ğŸ­ Scenarios</button>
            </div>
            Select an asteroid (click name) to populate report. Open browser console to see fetched data.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- External JS -->
  <script type="module" src="impact-map.js"></script>
  <script type="module" src="scenarios.js"></script>
  <script type="module" src="main.js"></script>

  <!-- Asteroid search bar logic is now handled in main.js after asteroidCache is defined. -->
</body>
</html>
